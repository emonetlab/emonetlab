{%- comment -%}
  This file ONLY generates the HTML for one album's images.
  The <script> tag has been REMOVED.
  A class "lightgallery-album" has been ADDED to the main div.
{%- endcomment -%}

<div id="{{ include.albumname | slugify }}" class="lightgallery-album">

    {%- assign details_filename = include.albumname | append: '_details' -%}
    {%- assign captions_data = site.data.galleries[details_filename] -%}

    {%- for image in site.static_files -%}
    {%- if image.path contains include.albumname and image.path contains 'images/gallery' -%}
    {%- unless image.path contains 'thumbnails' -%}

    {%- assign image_details = captions_data | where: 'filename', image.name | first -%}

    {%- if image_details -%}
      {%- assign caption_text = image_details.caption -%}
    {%- else -%}
      {%- assign caption_text = "" -%}
    {%- endif -%}

    {%- assign caption_id = include.albumname | slugify | append: '-' | append: forloop.index -%}

    <a href="{{ image.path | relative_url }}" data-sub-html="#{{ caption_id }}">
        <img src="/thumbnails{{ image.path | relative_url }}" loading="lazy" />

        <div id="{{ caption_id }}" style="display:none;">
            <h4>{{ caption_text }}</h4>
        </div>
    </a>

    {%- endunless -%}
    {%- endif -%}
    {%- endfor -%}
</div>
